(this.webpackJsonprandom_chat=this.webpackJsonprandom_chat||[]).push([[0],{14:function(e,t,a){e.exports={container_messages:"Messages_container_messages__3ZPel",firstUser:"Messages_firstUser__2s8jD",secondUser:"Messages_secondUser__1KwU2",systemMessage:"Messages_systemMessage__2nVOr"}},34:function(e,t,a){e.exports={container:"App_container__3wFbf"}},37:function(e,t,a){e.exports=a.p+"static/media/770.0a98a704.gif"},38:function(e,t,a){e.exports={container:"StartPage_container__3KLsk"}},40:function(e,t,a){e.exports={container:"ChatPage_container__gDbn5",buttonOut:"ChatPage_buttonOut__3OW67"}},42:function(e,t,a){e.exports=a(70)},47:function(e,t,a){},70:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(16),c=a.n(r),o=(a(47),a(34)),u=a.n(o),i=a(7),l=a(23),d=a(15),m=a(36),g=a.n(m).a.create({baseURL:"https://vast-sands-32724.herokuapp.com/"}),f=function(){return g.post("user")},h=function(e){return g.get("user?userId=".concat(e))},E=function(e,t,a){return g.get("message?userId=".concat(e,"&chatId=").concat(t,"&date=").concat(a))},_=function(e,t,a){return g.post("message",{userId:e,chatId:t,message:a})},b={userId:0,isFetching:!1,chatId:0,messages:[],isLoading:!1},v=function(e,t){return{type:"SET_USER",userId:e,status:t}},I=function(e,t){return{type:"SET_USER_IN_CHAT",status:e,chatId:t}},p=function(e){return function(t,a){var n=a().users;_(n.userId,n.chatId,e).then((function(a){"1qaz2wsx3edc"===e&&t(I("1qaz2wsx3edc",0))}))}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return Object(d.a)({},e,{userId:t.userId,isFetching:"wait"===t.status,isLoading:0===t.userId,messages:[]});case"SET_USER_IN_CHAT":return Object(d.a)({},e,{chatId:t.chatId,isLoading:0===t.chatId,isFetching:!("found"===t.status||"1qaz2wsx3edc"===t.status)});case"SET_MESSAGES":return Object(d.a)({},e,{messages:t.messages.length?[].concat(Object(l.a)(e.messages),Object(l.a)(t.messages)):e.messages,isLoading:!1});case"SET_IS_LOADING":return Object(d.a)({},e,{isLoading:t.isLoading})}return e},S=a(10),w=a(37),j=a.n(w);var y=function(){return s.a.createElement("div",null,s.a.createElement("img",{src:j.a}))},T=a(38),L=a.n(T);var N=function(){var e=Object(i.c)((function(e){return e.users})),t=e.isFetching,a=e.chatId,r=e.isLoading,c=Object(i.b)();return Object(n.useEffect)((function(){t&&!r&&setTimeout((function(){c((function(e,t){e(I("wait",0)),h(t().users.userId).then((function(t){e(I(t.data.status,t.data.chatId))}))}))}),1500)}),[t,r]),a?s.a.createElement(S.a,{to:"/chat_page"}):s.a.createElement("div",{className:L.a.container},t?s.a.createElement(y,null):s.a.createElement("button",{onClick:function(){c((function(e){e(v(0,"wait")),f().then((function(t){e(v(t.data.userId,t.data.status))}))}))},disabled:t},"Start a random conversation"))},x=a(18);var U=function(){var e=Object(n.useState)(""),t=Object(x.a)(e,2),a=t[0],r=t[1],c=Object(i.b)(),o=function(){0!==a.length&&(r(""),c(p(a)))};return s.a.createElement("div",{className:"App",style:{display:"flex",alignItems:"center",justifyContent:"center"}},s.a.createElement("textarea",{onChange:function(e){r(e.currentTarget.value)},value:a,onKeyPress:function(e){"Enter"===e.key&&e.shiftKey&&o()},style:{margin:5,width:250,height:50,resize:"none",outline:"none"}}),s.a.createElement("button",{onClick:o},"SEND"))},k=a(14),M=a.n(k);var A=function(e){var t=s.a.createRef();Object(n.useEffect)((function(){t.current.scroll(0,Number.MAX_SAFE_INTEGER)}),[e.messages]);var a=e.messages.map((function(t,a){var n=e.userId===t.userId?M.a.firstUser:0===t.userId?M.a.systemMessage:M.a.secondUser;return s.a.createElement("div",null,s.a.createElement("div",{key:a,className:n},s.a.createElement("pre",null,0===t.userId?"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043f\u043e\u043a\u0438\u043d\u0443\u043b \u0447\u0430\u0442":t.message,s.a.createElement("br",null),s.a.createElement("div",null,new Date(t.date).getHours(),":",new Date(t.date).getMinutes()))))}));return s.a.createElement("div",{className:M.a.container_messages,style:{height:350,overflow:"auto"},ref:t},a)},C=a(40),D=a.n(C);var R=function(){var e=Object(i.c)((function(e){return e.users})),t=e.chatId,a=e.messages,r=e.isLoading,c=e.userId,o=Object(n.useState)(!1),u=Object(x.a)(o,2),l=u[0],d=u[1],m=Object(i.b)();return Object(n.useEffect)((function(){t&&!r&&setTimeout((function(){m((function(e,t){var a=t().users,n=a.messages.length?a.messages[a.messages.length-1].date:0;e({type:"SET_IS_LOADING",isLoading:!0}),E(a.userId,a.chatId,n).then((function(t){var a,n;e((a=t.data.status,n=t.data.messages,{type:"SET_MESSAGES",status:a,messages:n}))}))}))}),1500)}),[r,t]),t?s.a.createElement("div",{className:D.a.container},s.a.createElement("div",null,s.a.createElement("button",{onClick:function(){d(!0),m(p("1qaz2wsx3edc"))},disabled:l},"out")),s.a.createElement(A,{messages:a,userId:c}),s.a.createElement(U,null)):(l&&d(!1),s.a.createElement(S.a,{to:"/start_page"}))};var F=function(){return s.a.createElement("div",{className:u.a.container},s.a.createElement(S.b,{render:function(){return s.a.createElement(N,null)},patch:"/start_page"}),s.a.createElement(S.b,{render:function(){return s.a.createElement(R,null)},patch:"/chat_page"}),s.a.createElement(S.b,{render:function(){return s.a.createElement(S.a,{to:"/chat_page"})},patch:"/"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var z=a(11),G=a(41),P=Object(z.c)({users:O}),q=Object(z.d)(P,Object(z.a)(G.a));window.store=q;var K=q,H=a(12);c.a.render(s.a.createElement(H.a,null,s.a.createElement(i.a,{store:K},s.a.createElement(F,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[42,1,2]]]);
//# sourceMappingURL=main.ae68a8c2.chunk.js.map