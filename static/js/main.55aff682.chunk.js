(this.webpackJsonprandom_chat=this.webpackJsonprandom_chat||[]).push([[0],{16:function(e,t,n){e.exports={container_messages:"Messages_container_messages__3ZPel",firstUser:"Messages_firstUser__2s8jD",secondUser:"Messages_secondUser__1KwU2",systemMessage:"Messages_systemMessage__2nVOr"}},34:function(e,t,n){e.exports={container:"App_container__3wFbf"}},37:function(e,t,n){e.exports=n.p+"static/media/770.0a98a704.gif"},38:function(e,t,n){e.exports={container:"StartPage_container__3KLsk"}},40:function(e,t,n){e.exports={container:"ChatPage_container__gDbn5",buttonOut:"ChatPage_buttonOut__3OW67"}},42:function(e,t,n){e.exports=n(70)},47:function(e,t,n){},70:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(18),c=n.n(r),u=(n(47),n(34)),o=n.n(u),i=n(15),l=n(11),d=n(7),m=n(17),f=n(36),g=n.n(f).a.create({baseURL:"https://vast-sands-32724.herokuapp.com/"}),E=function(e,t){return g.post("user",{sex:e,findSex:t})},h=function(e){return g.get("user?userId=".concat(e))},b=function(e,t,n){return g.get("message?userId=".concat(e,"&chatId=").concat(t,"&date=").concat(n))},_=function(e,t,n){return g.post("message",{userId:e,chatId:t,message:n})},v={userId:0,isFetching:!1,chatId:0,messages:[],isLoading:!1},p=function(e,t){return{type:"SET_USER",userId:e,status:t}},I=function(e,t){return{type:"SET_USER_IN_CHAT",status:e,chatId:t}},O=function(e){return function(t,n){var a=n().users;_(a.userId,a.chatId,e).then((function(n){"1qaz2wsx3edc"===e&&t(I("1qaz2wsx3edc",0))}))}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return Object(m.a)({},e,{userId:t.userId,isFetching:"wait"===t.status,isLoading:0===t.userId,messages:[]});case"SET_USER_IN_CHAT":return Object(m.a)({},e,{chatId:t.chatId,isLoading:0===t.chatId,isFetching:!("found"===t.status||"1qaz2wsx3edc"===t.status)});case"SET_MESSAGES":return Object(m.a)({},e,{messages:t.messages.length?[].concat(Object(i.a)(e.messages),Object(i.a)(t.messages)):e.messages,isLoading:!1});case"SET_IS_LOADING":return Object(m.a)({},e,{isLoading:t.isLoading})}return e},j=n(10),y=n(37),w=n.n(y);var x=function(){return s.a.createElement("div",null,s.a.createElement("img",{src:w.a}))},k=n(38),T=n.n(k);var L=function(){var e=Object(d.c)((function(e){return e.users})),t=e.isFetching,n=e.chatId,r=e.isLoading,c=Object(d.b)(),u=Object(a.useState)(void 0),o=Object(l.a)(u,2),m=o[0],f=o[1],g=Object(a.useState)(["all"]),b=Object(l.a)(g,2),_=b[0],v=b[1],O=["male","female","else"],S=function(e){_.find((function(t){return t===e}))?v((function(t){return t.filter((function(t){return t!==e}))})):v((function(t){return[].concat(Object(i.a)(t),[e])}))};return Object(a.useEffect)((function(){t&&!r&&setTimeout((function(){c((function(e,t){e(I("wait",0)),h(t().users.userId).then((function(t){e(I(t.data.status,t.data.chatId))}))}))}),1500)}),[t,r]),n?s.a.createElement(j.a,{to:"/chat_page"}):s.a.createElement("div",{className:T.a.container},t?s.a.createElement(x,null):s.a.createElement("div",{style:{display:"flex",flexFlow:"column"}},"my sex:",s.a.createElement("select",{value:void 0,onChange:function(e){return f(e.currentTarget.value)}},s.a.createElement("option",{value:void 0},"none"),O.map((function(e,t){return s.a.createElement("option",{key:"o"+t,value:e},e)}))),"find sex:",s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",checked:!!_.find((function(e){return"all"===e})),onChange:function(){return S("all")}}),"all"),O.map((function(e,t){return s.a.createElement("label",{key:"s"+t},s.a.createElement("input",{type:"checkbox",checked:!!_.find((function(t){return t===e})),onChange:function(){return S(e)}}),e)})),s.a.createElement("button",{onClick:function(){c(function(e,t){return function(n){n(p(0,"wait")),E(e,t).then((function(e){n(p(e.data.userId,e.data.status))}))}}(m,_))},disabled:t},"Start a random conversation")))};var N=function(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Object(d.b)(),u=function(){0!==n.length&&(r(""),c(O(n)))};return s.a.createElement("div",{className:"App",style:{display:"flex",alignItems:"center",justifyContent:"center"}},s.a.createElement("textarea",{onChange:function(e){r(e.currentTarget.value)},value:n,onKeyPress:function(e){"Enter"===e.key&&e.shiftKey&&u()},style:{margin:5,width:250,height:50,resize:"none",outline:"none"}}),s.a.createElement("button",{onClick:u},"SEND"))},C=n(16),U=n.n(C);var M=function(e){var t=s.a.createRef();Object(a.useEffect)((function(){t.current.scroll(0,Number.MAX_SAFE_INTEGER)}),[e.messages]);var n=e.messages.map((function(t,n){var a=e.userId===t.userId?U.a.firstUser:0===t.userId?U.a.systemMessage:U.a.secondUser;return s.a.createElement("div",null,s.a.createElement("div",{key:n,className:a},s.a.createElement("pre",null,0===t.userId?"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043f\u043e\u043a\u0438\u043d\u0443\u043b \u0447\u0430\u0442":t.message,s.a.createElement("br",null),s.a.createElement("div",null,new Date(t.date).getHours(),":",new Date(t.date).getMinutes()))))}));return s.a.createElement("div",{className:U.a.container_messages,style:{height:350,overflow:"auto"},ref:t},n)},A=n(40),D=n.n(A);var F=function(){var e=Object(d.c)((function(e){return e.users})),t=e.chatId,n=e.messages,r=e.isLoading,c=e.userId,u=Object(a.useState)(!1),o=Object(l.a)(u,2),i=o[0],m=o[1],f=Object(d.b)();return Object(a.useEffect)((function(){t&&!r&&setTimeout((function(){f((function(e,t){var n=t().users,a=n.messages.length?n.messages[n.messages.length-1].date:0;e({type:"SET_IS_LOADING",isLoading:!0}),b(n.userId,n.chatId,a).then((function(t){var n,a;e((n=t.data.status,a=t.data.messages,{type:"SET_MESSAGES",status:n,messages:a}))}))}))}),1500)}),[r,t]),t?s.a.createElement("div",{className:D.a.container},s.a.createElement("div",null,s.a.createElement("button",{onClick:function(){m(!0),f(O("1qaz2wsx3edc"))},disabled:i},"out")),s.a.createElement(M,{messages:n,userId:c}),s.a.createElement(N,null)):(i&&m(!1),s.a.createElement(j.a,{to:"/start_page"}))};var R=function(){return s.a.createElement("div",{className:o.a.container},s.a.createElement(j.b,{render:function(){return s.a.createElement(L,null)},patch:"/start_page"}),s.a.createElement(j.b,{render:function(){return s.a.createElement(F,null)},patch:"/chat_page"}),s.a.createElement(j.b,{render:function(){return s.a.createElement(j.a,{to:"/chat_page"})},patch:"/"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var z=n(12),G=n(41),P=Object(z.c)({users:S}),q=Object(z.d)(P,Object(z.a)(G.a));window.store=q;var K=q,H=n(13);c.a.render(s.a.createElement(H.a,null,s.a.createElement(d.a,{store:K},s.a.createElement(R,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[42,1,2]]]);
//# sourceMappingURL=main.55aff682.chunk.js.map