(this.webpackJsonprandom_chat=this.webpackJsonprandom_chat||[]).push([[0],{35:function(e,t,a){e.exports=a.p+"static/media/770.0a98a704.gif"},38:function(e,t,a){e.exports=a(67)},43:function(e,t,a){},44:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(15),r=a.n(s),u=(a(43),a(44),a(7)),o=a(22),i=a(14),d=a(34),l=a.n(d).a.create({baseURL:"https://vast-sands-32724.herokuapp.com/"}),m=function(){return l.post("user")},f=function(e){return l.get("user?userId=".concat(e))},g=function(e,t,a){return l.get("message?userId=".concat(e,"&chatId=").concat(t,"&date=").concat(a))},h=function(e,t,a){return l.post("message",{userId:e,chatId:t,message:a})},E={userId:0,isFetching:!1,chatId:0,messages:[],isLoading:!1},p=function(e,t){return{type:"SET_USER",userId:e,status:t}},b=function(e,t){return{type:"SET_USER_IN_CHAT",status:e,chatId:t}},v=function(e){return function(t,a){var n=a().users;h(n.userId,n.chatId,e).then((function(a){"1qaz2wsx3edc"===e&&t(b("1qaz2wsx3edc",0))}))}},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return Object(i.a)({},e,{userId:t.userId,isFetching:"wait"===t.status,isLoading:0===t.userId,messages:[]});case"SET_USER_IN_CHAT":return Object(i.a)({},e,{chatId:t.chatId,isLoading:0===t.chatId,isFetching:!("found"===t.status||"1qaz2wsx3edc"===t.status)});case"SET_MESSAGES":return Object(i.a)({},e,{messages:[].concat(Object(o.a)(e.messages),Object(o.a)(t.messages)),isLoading:!1});case"SET_IS_LOADING":return Object(i.a)({},e,{isLoading:t.isLoading})}return e},S=a(10),O=a(35),_=a.n(O);var j=function(){return c.a.createElement("div",null,c.a.createElement("img",{src:_.a}))};var w=function(){var e=Object(u.c)((function(e){return e.users})),t=e.isFetching,a=e.chatId,s=e.isLoading,r=Object(u.b)();return Object(n.useEffect)((function(){t&&!s&&setTimeout((function(){r((function(e,t){e(b("wait",0)),f(t().users.userId).then((function(t){e(b(t.data.status,t.data.chatId))}))}))}),1500)}),[t,s]),a?c.a.createElement(S.a,{to:"/chat_page"}):c.a.createElement("div",{className:"App"},c.a.createElement("button",{onClick:function(){r((function(e){e(p(0,"wait")),m().then((function(t){e(p(t.data.userId,t.data.status))}))}))},disabled:t},"Start a random conversation"),t&&c.a.createElement(j,null))},T=a(17);var L=function(){var e=Object(n.useState)(""),t=Object(T.a)(e,2),a=t[0],s=t[1],r=Object(u.b)(),o=function(){0!==a.length&&(s(""),r(v(a)))};return c.a.createElement("div",{className:"App"},c.a.createElement("input",{onChange:function(e){s(e.currentTarget.value)},value:a,onKeyPress:function(e){"Enter"===e.key&&e.shiftKey&&o()}}),c.a.createElement("button",{onClick:o},"SEND"))};var y=function(){var e=Object(u.c)((function(e){return e.users})),t=e.chatId,a=e.messages,s=e.isLoading,r=Object(n.useState)(!1),o=Object(T.a)(r,2),i=o[0],d=o[1],l=Object(u.b)();return Object(n.useEffect)((function(){t&&!s&&setTimeout((function(){l((function(e,t){var a=t().users,n=a.messages.length?a.messages[a.messages.length-1].date:0;e({type:"SET_IS_LOADING",isLoading:!0}),g(a.userId,a.chatId,n).then((function(t){var a,n;e((a=t.data.status,n=t.data.messages,{type:"SET_MESSAGES",status:a,messages:n}))}))}))}),1500)}),[s,t]),t?c.a.createElement("div",{className:"App"},c.a.createElement("button",{onClick:function(){d(!0),l(v("1qaz2wsx3edc"))},disabled:i},"out"),a.map((function(e,t){return c.a.createElement("div",{key:t},e.message)})),c.a.createElement(L,null)):c.a.createElement(S.a,{to:"/start_page"})};var k=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(S.b,{render:function(){return c.a.createElement(w,null)},patch:"/start_page"}),c.a.createElement(S.b,{render:function(){return c.a.createElement(y,null)},patch:"/chat_page"}),c.a.createElement(S.b,{render:function(){return c.a.createElement(S.a,{to:"/chat_page"})},patch:"/"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var A=a(11),N=a(37),x=Object(A.c)({users:I}),C=Object(A.d)(x,Object(A.a)(N.a));window.store=C;var R=C,U=a(12);r.a.render(c.a.createElement(U.a,null,c.a.createElement(u.a,{store:R},c.a.createElement(k,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[38,1,2]]]);
//# sourceMappingURL=main.5949ae9f.chunk.js.map