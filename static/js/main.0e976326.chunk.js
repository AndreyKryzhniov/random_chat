(this.webpackJsonprandom_chat=this.webpackJsonprandom_chat||[]).push([[0],{35:function(e,t,a){e.exports=a.p+"static/media/770.0a98a704.gif"},38:function(e,t,a){e.exports=a(67)},43:function(e,t,a){},44:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(15),s=a.n(r),u=(a(43),a(44),a(11)),o=a(7),i=a(22),l=a(17),d=a(34),m=a.n(d).a.create({baseURL:"https://vast-sands-32724.herokuapp.com/"}),f=function(){return m.post("user")},h=function(e){return m.get("user?userId=".concat(e))},E=function(e,t,a){return m.get("message?userId=".concat(e,"&chatId=").concat(t,"&date=").concat(a))},g=function(e,t,a){return m.post("message",{userId:e,chatId:t,message:a})},b={userId:0,isFetching:!1,chatId:0,messages:[]},v=function(e,t){return{type:"SET_USER",userId:e,status:t}},p=function(e,t){return{type:"SET_USER_IN_CHAT",status:e,chatId:t}},I=function(e){return function(t,a){var n=a().users;g(n.userId,n.chatId,e).then((function(a){"1qaz2wsx3edc"===e&&t(p("1qaz2wsx3edc",0))}))}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return Object(l.a)({},e,{userId:t.userId,isFetching:"wait"===t.status,messages:[]});case"SET_USER_IN_CHAT":return Object(l.a)({},e,{chatId:t.chatId,isFetching:!("found"===t.status||"1qaz2wsx3edc"===t.status)});case"SET_MESSAGES":return Object(l.a)({},e,{messages:[].concat(Object(i.a)(e.messages),Object(i.a)(t.messages))})}return e},O=a(10),S=a(35),_=a.n(S);var w=function(){return c.a.createElement("div",null,c.a.createElement("img",{src:_.a}))};var k=function(){var e=Object(n.useState)(),t=Object(u.a)(e,2),a=t[0],r=t[1],s=Object(o.c)((function(e){return e.users.isFetching})),i=Object(o.c)((function(e){return e.users.chatId})),l=Object(o.b)();return Object(n.useEffect)((function(){return clearInterval(a),s&&r(setInterval((function(){l((function(e,t){h(t().users.userId).then((function(t){e(p(t.data.status,t.data.chatId))}))}))}),1e3)),function(){return clearInterval(a)}}),[s]),i?c.a.createElement(O.a,{to:"/chat_page"}):c.a.createElement("div",{className:"App"},c.a.createElement("button",{onClick:function(){l((function(e){e(v(0,"wait")),f().then((function(t){e(v(t.data.userId,t.data.status))}))}))},disabled:s},"Start a random conversation"),s&&c.a.createElement(w,null))};var y=function(){var e=Object(n.useState)(""),t=Object(u.a)(e,2),a=t[0],r=t[1],s=Object(o.b)(),i=function(){0!==a.length&&(r(""),s(I(a)))};return c.a.createElement("div",{className:"App"},c.a.createElement("input",{onChange:function(e){r(e.currentTarget.value)},value:a,onKeyPress:function(e){"Enter"===e.key&&e.shiftKey&&i()}}),c.a.createElement("button",{onClick:i},"SEND"))};var T=function(){var e=Object(o.c)((function(e){return e.users})),t=e.chatId,a=e.messages,r=Object(n.useState)(!1),s=Object(u.a)(r,2),i=s[0],l=s[1],d=Object(o.b)(),m=Object(n.useState)(),f=Object(u.a)(m,2),h=f[0],g=f[1];return Object(n.useEffect)((function(){return clearInterval(h),t&&g(setInterval((function(){d((function(e,t){var a=t().users,n=a.messages.length?a.messages[a.messages.length-1].date:0;E(a.userId,a.chatId,n).then((function(t){var a,n;e((a=t.data.status,n=t.data.messages,{type:"SET_MESSAGES",status:a,messages:n}))}))}))}),1e3)),function(){return clearInterval(h)}}),[t]),t?c.a.createElement("div",{className:"App"},c.a.createElement("button",{onClick:function(){l(!0),d(I("1qaz2wsx3edc"))},disabled:i},"out"),a.map((function(e,t){return c.a.createElement("div",{key:t},e.message)})),c.a.createElement(y,null)):c.a.createElement(O.a,{to:"/start_page"})};var A=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(O.b,{render:function(){return c.a.createElement(k,null)},patch:"/start_page"}),c.a.createElement(O.b,{render:function(){return c.a.createElement(T,null)},patch:"/chat_page"}),c.a.createElement(O.b,{render:function(){return c.a.createElement(O.a,{to:"/chat_page"})},patch:"/"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var N=a(12),x=a(37),C=Object(N.c)({users:j}),R=Object(N.d)(C,Object(N.a)(x.a)),U=a(13);s.a.render(c.a.createElement(U.a,null,c.a.createElement(o.a,{store:R},c.a.createElement(A,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[38,1,2]]]);
//# sourceMappingURL=main.0e976326.chunk.js.map