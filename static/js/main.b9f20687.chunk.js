(this.webpackJsonprandom_chat=this.webpackJsonprandom_chat||[]).push([[0],{37:function(e,t,a){e.exports=a(66)},42:function(e,t,a){},43:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(15),s=a.n(r),u=(a(42),a(43),a(11)),o=a(7),i=a(22),l=a(17),d=a(34),m=a.n(d).a.create({baseURL:"https://vast-sands-32724.herokuapp.com/"}),f=function(){return m.post("user")},h=function(e){return m.get("user?userId=".concat(e))},E=function(e,t,a){return m.get("message?userId=".concat(e,"&chatId=").concat(t,"&date=").concat(a))},b=function(e,t,a){return m.post("message",{userId:e,chatId:t,message:a})},g={userId:0,isFetching:!1,chatId:0,messages:[]},v=function(e,t){return{type:"SET_USER",userId:e,status:t}},p=function(e,t){return{type:"SET_USER_IN_CHAT",status:e,chatId:t}},I=function(e){return function(t,a){var n=a().users;b(n.userId,n.chatId,e).then((function(a){"1qaz2wsx3edc"===e&&t(p("1qaz2wsx3edc",0))}))}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return Object(l.a)({},e,{userId:t.userId,isFetching:"wait"===t.status,messages:[]});case"SET_USER_IN_CHAT":return Object(l.a)({},e,{chatId:t.chatId,isFetching:!("found"===t.status||"1qaz2wsx3edc"===t.status)});case"SET_MESSAGES":return Object(l.a)({},e,{messages:[].concat(Object(i.a)(e.messages),Object(i.a)(t.messages))})}return e},O=a(10);var S=function(){var e=Object(n.useState)(),t=Object(u.a)(e,2),a=t[0],r=t[1],s=Object(o.c)((function(e){return e.users.isFetching})),i=Object(o.c)((function(e){return e.users.chatId})),l=Object(o.b)();return Object(n.useEffect)((function(){return clearInterval(a),s&&r(setInterval((function(){l((function(e,t){h(t().users.userId).then((function(t){e(p(t.data.status,t.data.chatId))}))}))}),1e3)),function(){return clearInterval(a)}}),[s]),i?c.a.createElement(O.a,{to:"/chat_page"}):c.a.createElement("div",{className:"App"},c.a.createElement("button",{onClick:function(){l((function(e){e(v(0,"wait")),f().then((function(t){e(v(t.data.userId,t.data.status))}))}))},disabled:s},"Start a random conversation"))};var _=function(){var e=Object(n.useState)(""),t=Object(u.a)(e,2),a=t[0],r=t[1],s=Object(o.b)();return c.a.createElement("div",{className:"App"},c.a.createElement("input",{onChange:function(e){r(e.currentTarget.value)},value:a}),c.a.createElement("button",{onClick:function(){r(""),s(I(a))}},"SEND"))};var w=function(){var e=Object(o.c)((function(e){return e.users})),t=e.chatId,a=e.messages,r=Object(n.useState)(!1),s=Object(u.a)(r,2),i=s[0],l=s[1],d=Object(o.b)(),m=Object(n.useState)(),f=Object(u.a)(m,2),h=f[0],b=f[1];return Object(n.useEffect)((function(){return clearInterval(h),t&&b(setInterval((function(){d((function(e,t){var a=t().users,n=a.messages.length?a.messages[a.messages.length-1].date:0;E(a.userId,a.chatId,n).then((function(t){var a,n;e((a=t.data.status,n=t.data.messages,{type:"SET_MESSAGES",status:a,messages:n}))}))}))}),1e3)),function(){return clearInterval(h)}}),[t]),t?c.a.createElement("div",{className:"App"},c.a.createElement("button",{onClick:function(){l(!0),d(I("1qaz2wsx3edc"))},disabled:i},"out"),a.map((function(e,t){return c.a.createElement("div",{key:t},e.message)})),c.a.createElement(_,null)):c.a.createElement(O.a,{to:"/start_page"})};var k=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(O.b,{render:function(){return c.a.createElement(S,null)},patch:"/start_page"}),c.a.createElement(O.b,{render:function(){return c.a.createElement(w,null)},patch:"/chat_page"}),c.a.createElement(O.b,{render:function(){return c.a.createElement(O.a,{to:"/chat_page"})},patch:"/"}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var T=a(12),A=a(36),y=Object(T.c)({users:j}),N=Object(T.d)(y,Object(T.a)(A.a)),C=a(13);s.a.render(c.a.createElement(C.a,null,c.a.createElement(o.a,{store:N},c.a.createElement(k,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.b9f20687.chunk.js.map